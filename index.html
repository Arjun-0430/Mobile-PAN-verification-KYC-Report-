<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KYC Verification Portal</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- jsPDF and html2canvas for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <style>
        /* Custom styles for the new design */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f8fc;
        }

        /* New Lime-Yellow to Black Gradient Background */
        #home-screen {
             background: linear-gradient(135deg, #fde047 0%, #1e293b 100%);
        }
        
        /* Enhanced Glassmorphism effect for cards */
        .card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.2);
        }
        .card:hover {
            transform: translateY(-8px);
            box-shadow: 0 16px 40px rgba(0, 0, 0, 0.3);
        }

        /* Enhanced Report Page Background */
        #report-screen-bg {
            background-color: #f8f9fa;
            background-image:
                linear-gradient(rgba(102, 126, 234, 0.05) 1px, transparent 1px),
                linear-gradient(to right, rgba(102, 126, 234, 0.05) 1px, transparent 1px);
            background-size: 20px 20px;
        }

        /* Button with Shadow */
        .button-shadow {
            box-shadow: 0 4px 14px 0 rgba(79, 70, 229, 0.39);
            transition: all 0.3s ease;
        }
        .button-shadow:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px 0 rgba(79, 70, 229, 0.5);
        }
        
        /* Reshaped Download Button */
        #download-pdf-btn {
            border-radius: 9999px; /* Pill shape */
            box-shadow: 0 4px 14px 0 rgba(22, 163, 74, 0.39);
        }
         #download-pdf-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px 0 rgba(22, 163, 74, 0.5);
        }
        
        /* Styles for Report Tabs */
        .report-tab-btn {
            border-bottom: 3px solid transparent;
            transition: all 0.2s ease-in-out;
        }
        .report-tab-active {
            border-bottom-color: #4f46e5;
            color: #4f46e5;
            font-weight: 600;
        }

        /* Spinner animation */
        .loader {
            border: 4px solid #e5e7eb;
            border-top: 4px solid #4f46e5;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Custom toast notification */
        #toast {
            position: fixed;
            top: 20px;
            right: 20px;
            transform: translateX(120%);
            transition: transform 0.5s ease-in-out;
            z-index: 100;
        }
        #toast.show {
            transform: translateX(0);
        }
    </style>
</head>
<body class="antialiased text-gray-900">

    <!-- Main Container -->
    <div class="min-h-screen">
        <!-- Home Screen -->
        <div id="home-screen" class="min-h-screen">
            <div class="container mx-auto px-4 py-12 sm:py-16 flex flex-col justify-center min-h-screen">
                <header class="text-center mb-12">
                    <h1 class="text-4xl sm:text-5xl font-extrabold text-white tracking-tight">Verification Suite</h1>
                    <p class="text-lg text-yellow-100 mt-3 max-w-2xl mx-auto">Select a service to begin. Secure, fast, and reliable identity verification powered by AI.</p>
                </header>

                <!-- Verification Options Grid -->
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
                    <!-- Mobile to PAN Card -->
                    <div id="mobile-to-pan-card" class="card rounded-2xl p-6 text-center cursor-pointer">
                        <div class="bg-white/30 rounded-full h-16 w-16 flex items-center justify-center mx-auto mb-4">
                            <svg class="h-8 w-8 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" /></svg>
                        </div>
                        <h3 class="font-bold text-xl text-white">Mobile to PAN</h3>
                        <p class="text-yellow-100 text-sm mt-1">Prefill data from mobile.</p>
                    </div>
                    <!-- Other cards (disabled) -->
                    <div class="card rounded-2xl p-6 text-center opacity-60 cursor-not-allowed">
                        <div class="bg-white/30 rounded-full h-16 w-16 flex items-center justify-center mx-auto mb-4"><svg class="h-8 w-8 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z" /></svg></div>
                        <h3 class="font-bold text-xl text-white">PAN Verification</h3>
                        <p class="text-yellow-100 text-sm mt-1">Coming Soon</p>
                    </div>
                    <div class="card rounded-2xl p-6 text-center opacity-60 cursor-not-allowed">
                        <div class="bg-white/30 rounded-full h-16 w-16 flex items-center justify-center mx-auto mb-4"><svg class="h-8 w-8 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 012-2h4a2 2 0 012 2v1m-4 0h4" /></svg></div>
                        <h3 class="font-bold text-xl text-white">Aadhaar Verification</h3>
                        <p class="text-yellow-100 text-sm mt-1">Coming Soon</p>
                    </div>
                    <div class="card rounded-2xl p-6 text-center opacity-60 cursor-not-allowed">
                        <div class="bg-white/30 rounded-full h-16 w-16 flex items-center justify-center mx-auto mb-4"><svg class="h-8 w-8 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z" /></svg></div>
                        <h3 class="font-bold text-xl text-white">Bank Verification</h3>
                        <p class="text-yellow-100 text-sm mt-1">Coming Soon</p>
                    </div>
                </div>
            </div>
            
            <!-- Form Modal/Section -->
            <div id="form-section" class="hidden fixed inset-0 bg-gray-900 bg-opacity-60 flex items-center justify-center z-50">
                <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-lg w-full m-4">
                     <h2 class="text-2xl font-bold mb-2">Mobile to PAN Prefill</h2>
                     <p class="text-gray-500 mb-6">Enter details to generate the verification report.</p>
                     <form id="mobile-to-pan-form" class="space-y-4">
                        <div>
                            <label for="name" class="block text-sm font-medium text-gray-700">Full Name</label>
                            <input type="text" id="name" name="name" class="mt-1 block w-full px-4 py-3 bg-gray-100 border-transparent rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" placeholder="e.g., Sateesh Singh">
                        </div>
                        <div>
                            <label for="mobile_no" class="block text-sm font-medium text-gray-700">Mobile Number</label>
                            <input type="text" id="mobile_no" name="mobile_no" class="mt-1 block w-full px-4 py-3 bg-gray-100 border-transparent rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" placeholder="e.g., 8888808969">
                        </div>
                        <div class="flex items-center justify-between pt-4">
                            <button type="button" id="cancel-btn" class="py-2 px-5 text-sm font-medium text-gray-600 rounded-lg hover:bg-gray-100">Cancel</button>
                            <button type="submit" class="button-shadow inline-flex justify-center py-3 px-6 border border-transparent text-sm font-medium rounded-lg text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                                Generate Report
                            </button>
                        </div>
                     </form>
                </div>
            </div>
        </div>

        <!-- Verification Report Screen -->
        <div id="report-screen" class="hidden">
            <div id="report-screen-bg" class="min-h-screen">
                <div class="container mx-auto p-4 sm:p-6 lg:p-8">
                    <!-- Report Header -->
                    <div class="flex flex-wrap justify-between items-center gap-4 mb-8">
                        <div>
                            <h1 class="text-3xl font-bold">Verification Report</h1>
                            <p id="report-date" class="text-gray-500"></p>
                        </div>
                        <div class="flex items-center gap-4">
                            <button id="back-to-home-btn" class="py-2 px-4 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-full hover:bg-gray-100">New Verification</button>
                            <button id="download-pdf-btn" class="button-shadow inline-flex items-center py-2 px-5 border border-transparent text-sm font-medium text-white bg-green-600 hover:bg-green-700">
                                <svg class="h-5 w-5 mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M17.293 9.293a1 1 0 011.414 1.414l-8 8a1 1 0 01-1.414 0l-8-8a1 1 0 111.414-1.414L9 16.586V3a1 1 0 112 0v13.586l5.293-5.293z" /></svg>
                                Download
                            </button>
                        </div>
                    </div>
                    
                    <!-- Report Body -->
                    <div id="report-content" class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <!-- Left Column: Profile Summary -->
                        <div class="lg:col-span-1">
                            <div id="profile-summary" class="bg-white rounded-2xl p-6 sticky top-8 shadow-lg">
                                <!-- Profile summary content injected here -->
                            </div>
                        </div>
                        <!-- Right Column: Detailed Info with Tabs -->
                        <div class="lg:col-span-2">
                             <div id="detailed-info" class="bg-white rounded-2xl p-6 shadow-lg">
                                <!-- Tabs will be injected here -->
                             </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Loader & Toast Notification -->
    <div id="loader-overlay" class="hidden fixed inset-0 bg-white bg-opacity-75 flex items-center justify-center z-50">
        <div class="loader"></div>
    </div>
    <div id="toast" class="bg-red-500 text-white py-3 px-6 rounded-lg shadow-lg">
        <p id="toast-message"></p>
    </div>


    <script>
        // --- Mock API Data ---
        const mockApiResponse = { /* ... same mock data as before ... */ };
        mockApiResponse.data = {
            "client_id": "mobile_to_prefill_v3_ScLOIHCrrmxZAqBQNStN", "mobile_number": "7827234123",
            "prefill_details": {
                "client_id": "prefill_report_v2_IJlNQIhKhyCnkzgYkNRH", "name": "SATEESH SINGH", "mobile": "7827234123",
                "personal_info": { "full_name": "SATEESH SINGH ", "dob": "1994-11-02", "gender": "Male", "total_income": "30000", "occupation": null, "age": "30" },
                "phone_info": [ { "reported_date": "2025-05-15", "type_code": "H", "number": "6219698802" }, { "reported_date": "2025-01-31", "type_code": "H", "number": "7491102312" } ],
                "address_info": [{ "address": "MURHARIA KAIMUR BHABU", "state": "BR", "type": "Owns,Permanent", "postal": "921102", "reported_date": "2025-05-15" }],
                "email_info": [{ "reported_date": "2025-01-31", "email_address": "SATEESH123@GMAIL.COM" }],
                "identity_info": {
                    "pan_number": [{ "id_number": "FYWPS1234M" }], "passport_number": [], "driving_license": [], "voter_id": [],
                    "aadhaar_number": [{ "id_number": "XXXXXXXXXXXX" }], "ration_card": [], "other_id": [{ "id_number": "30065940967604" }]
                }
            },
            "pan_details": {
                "pan_status": "success",
                "pan_details": {
                    "pan_number": "FYWPS1234M", "full_name": "SATEESH SINGH", "full_name_split": ["SATEESH", "SINGH"], "masked_aadhaar": "XXXXXXXX2902",
                    "address": { "line_1": "", "line_2": "", "street_name": "", "zip": "", "city": "", "state": "", "country": "", "full": "" },
                    "email": null, "phone_number": null, "gender": "M", "dob": "1994-11-02", "input_dob": null, "aadhaar_linked": true,
                    "dob_verified": false, "dob_check": false, "category": "person", "status": "valid", "less_info": false
                }
            }, "status": "success"
        };
        
        // --- DOM Elements ---
        const homeScreen = document.getElementById('home-screen');
        const reportScreen = document.getElementById('report-screen');
        const formSection = document.getElementById('form-section');
        const mobileToPanCard = document.getElementById('mobile-to-pan-card');
        const cancelBtn = document.getElementById('cancel-btn');
        const form = document.getElementById('mobile-to-pan-form');
        const loaderOverlay = document.getElementById('loader-overlay');
        const backToHomeBtn = document.getElementById('back-to-home-btn');

        // --- UI Interaction Logic ---
        mobileToPanCard.addEventListener('click', () => formSection.classList.remove('hidden'));
        cancelBtn.addEventListener('click', () => formSection.classList.add('hidden'));
        backToHomeBtn.addEventListener('click', () => {
            reportScreen.classList.add('hidden');
            homeScreen.classList.remove('hidden');
        });

        // --- Form Submission ---
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            const name = document.getElementById('name').value;
            const mobile = document.getElementById('mobile_no').value;

            if (!name || !mobile) {
                showToast('Please fill in both name and mobile number.');
                return;
            }

            formSection.classList.add('hidden');
            loaderOverlay.classList.remove('hidden');

            // Simulate API call
            setTimeout(() => {
                displayReport(mockApiResponse.data);
                loaderOverlay.classList.add('hidden');
                homeScreen.classList.add('hidden');
                reportScreen.classList.remove('hidden');
                window.scrollTo(0, 0);
            }, 1500);
        });
        
        // --- Toast Notification ---
        function showToast(message) {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toast-message');
            toastMessage.innerText = message;
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // --- Report Generation ---
        function displayReport(data) {
            const prefill = data.prefill_details;
            const pan = data.pan_details.pan_details;
            
            document.getElementById('report-date').innerText = `Generated on: ${new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}`;
            const profileSummary = document.getElementById('profile-summary');
            profileSummary.innerHTML = `
                <div class="text-center">
                    <div class="w-24 h-24 rounded-full bg-indigo-100 mx-auto flex items-center justify-center mb-4 ring-4 ring-white shadow-md">
                        <span class="text-3xl font-bold text-indigo-600">${prefill.personal_info.full_name.charAt(0)}</span>
                    </div>
                    <h2 class="text-2xl font-bold">${prefill.personal_info.full_name}</h2>
                    <p class="text-gray-500">${prefill.personal_info.occupation || 'Occupation not available'}</p>
                    <span class="mt-4 inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${data.status === 'success' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                        Verification ${data.status}
                    </span>
                </div>
                <div class="mt-6 border-t border-gray-200 pt-6 space-y-4 text-sm">
                    <div class="flex justify-between items-center">
                        <span class="font-medium text-gray-500">PAN</span>
                        <span class="font-mono bg-gray-100 px-2 py-1 rounded">${pan.pan_number}</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="font-medium text-gray-500">PAN Status</span>
                        <span class="font-medium capitalize text-green-600">${pan.status}</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="font-medium text-gray-500">Aadhaar Linked</span>
                        <span class="font-medium">${pan.aadhaar_linked ? 'Yes' : 'No'}</span>
                    </div>
                </div>
            `;

            const detailedInfoContainer = document.getElementById('detailed-info');
            detailedInfoContainer.innerHTML = `
                <!-- Tab Navigation -->
                <div class="border-b border-gray-200">
                    <nav id="report-tab-nav" class="flex space-x-6 -mb-px" aria-label="Tabs">
                        <button class="report-tab-btn py-3 px-1 text-sm report-tab-active" data-tab="personal">Personal Info</button>
                        <button class="report-tab-btn py-3 px-1 text-sm text-gray-500" data-tab="contact">Contact</button>
                        <button class="report-tab-btn py-3 px-1 text-sm text-gray-500" data-tab="address">Address</button>
                        <button class="report-tab-btn py-3 px-1 text-sm text-gray-500" data-tab="pan">PAN Details</button>
                        <button class="report-tab-btn py-3 px-1 text-sm text-gray-500" data-tab="aadhaar">Aadhaar Details</button>
                    </nav>
                </div>

                <!-- Tab Panels -->
                <div id="report-tab-content" class="pt-6">
                    <div id="personal" class="report-tab-panel space-y-4">
                        <h3 class="text-lg font-semibold">Personal Information</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                            <div class="bg-gray-50 p-3 rounded-lg"><strong>DOB:</strong> ${prefill.personal_info.dob}</div>
                            <div class="bg-gray-50 p-3 rounded-lg"><strong>Age:</strong> ${prefill.personal_info.age}</div>
                            <div class="bg-gray-50 p-3 rounded-lg"><strong>Gender:</strong> ${prefill.personal_info.gender}</div>
                            <div class="bg-gray-50 p-3 rounded-lg"><strong>Income:</strong> ${prefill.personal_info.total_income}</div>
                        </div>
                    </div>
                    <div id="contact" class="report-tab-panel hidden space-y-4">
                        <h3 class="text-lg font-semibold">Contact Details</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <h4 class="font-semibold mb-2 text-sm">Phone Numbers</h4>
                                <div class="space-y-2">
                                    ${prefill.phone_info.map(p => `<div class="bg-gray-50 p-3 rounded-lg text-sm"><p class="font-mono">${p.number}</p><p class="text-xs text-gray-500">Reported: ${p.reported_date}</p></div>`).join('') || '<p class="text-sm text-gray-400">No phone numbers found.</p>'}
                                </div>
                            </div>
                            <div>
                                <h4 class="font-semibold mb-2 text-sm">Email Addresses</h4>
                                <div class="space-y-2">
                                    ${prefill.email_info.map(e => `<div class="bg-gray-50 p-3 rounded-lg text-sm"><p>${e.email_address}</p><p class="text-xs text-gray-500">Reported: ${e.reported_date}</p></div>`).join('') || '<p class="text-sm text-gray-400">No emails found.</p>'}
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="address" class="report-tab-panel hidden space-y-4">
                         <h3 class="text-lg font-semibold">Addresses</h3>
                         ${prefill.address_info.map(a => `<div class="bg-gray-50 p-4 rounded-lg text-sm"><p>${a.address}, ${a.state} - ${a.postal}</p><p class="text-xs text-gray-500 mt-1">Type: ${a.type} | Reported: ${a.reported_date}</p></div>`).join('') || '<p class="text-sm text-gray-400">No addresses found.</p>'}
                    </div>
                    <div id="pan" class="report-tab-panel hidden space-y-4">
                         <h3 class="text-lg font-semibold">PAN Details</h3>
                         <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                            <div class="bg-gray-50 p-3 rounded-lg"><strong>PAN Number:</strong> <span class="font-mono">${pan.pan_number}</span></div>
                            <div class="bg-gray-50 p-3 rounded-lg"><strong>Full Name:</strong> ${pan.full_name}</div>
                            <div class="bg-gray-50 p-3 rounded-lg"><strong>Status:</strong> <span class="capitalize font-medium text-green-600">${pan.status}</span></div>
                            <div class="bg-gray-50 p-3 rounded-lg"><strong>Category:</strong> <span class="capitalize">${pan.category}</span></div>
                         </div>
                    </div>
                    <div id="aadhaar" class="report-tab-panel hidden space-y-4">
                         <h3 class="text-lg font-semibold">Aadhaar Details</h3>
                         <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                            <div class="bg-gray-50 p-3 rounded-lg"><strong>Masked Aadhaar:</strong> <span class="font-mono">${pan.masked_aadhaar}</span></div>
                            <div class="bg-gray-50 p-3 rounded-lg"><strong>Aadhaar Linked to PAN:</strong> <span class="font-medium">${pan.aadhaar_linked ? 'Yes' : 'No'}</span></div>
                         </div>
                    </div>
                </div>
            `;
            
            // Add Tab Switching Logic
            const tabNav = document.getElementById('report-tab-nav');
            const tabPanels = detailedInfoContainer.querySelectorAll('.report-tab-panel');
            const tabButtons = detailedInfoContainer.querySelectorAll('.report-tab-btn');

            tabNav.addEventListener('click', (e) => {
                if (e.target.classList.contains('report-tab-btn')) {
                    const tabId = e.target.getAttribute('data-tab');

                    tabButtons.forEach(btn => btn.classList.remove('report-tab-active', 'text-gray-500'));
                    e.target.classList.add('report-tab-active');
                    tabButtons.forEach(btn => { if(!btn.classList.contains('report-tab-active')) btn.classList.add('text-gray-500') });


                    tabPanels.forEach(panel => {
                        if (panel.id === tabId) {
                            panel.classList.remove('hidden');
                        } else {
                            panel.classList.add('hidden');
                        }
                    });
                }
            });
        }

        // --- PDF Download Logic ---
        const downloadBtn = document.getElementById('download-pdf-btn');
        const { jsPDF } = window.jspdf;

        downloadBtn.addEventListener('click', () => {
            const reportElement = document.getElementById('report-content');
            loaderOverlay.classList.remove('hidden');
            
            html2canvas(reportElement, {
                scale: 2,
                useCORS: true,
                backgroundColor: '#f8f9fa'
            }).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const pdf = new jsPDF({ orientation: 'p', unit: 'mm', format: 'a4' });
                
                const pdfWidth = pdf.internal.pageSize.getWidth();
                const canvasWidth = canvas.width;
                const canvasHeight = canvas.height;
                const ratio = canvasWidth / canvasHeight;
                const imgWidth = pdfWidth; 
                const imgHeight = imgWidth / ratio;
                
                pdf.addImage(imgData, 'PNG', 0, 0, imgWidth, imgHeight);
                pdf.save('KYC-Verification-Report.pdf');
                loaderOverlay.classList.add('hidden');
            }).catch(err => {
                console.error("Error generating PDF:", err);
                loaderOverlay.classList.add('hidden');
                showToast('Could not generate PDF.');
            });
        });

    </script>
</body>
</html>
